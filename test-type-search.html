<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•ç±»å‹æœç´¢åŠŸèƒ½</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-result {
            background: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>æµ‹è¯•ç±»å‹æœç´¢åŠŸèƒ½</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•è¯´æ˜</h2>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯• /resources/search æ¥å£æ˜¯å¦æ­£ç¡®æ”¯æŒ type å‚æ•°ã€‚</p>
        <p>è¯·æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†çš„æµ‹è¯•ç»“æœã€‚</p>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•æ“ä½œ</h2>
        <button onclick="testBasicSearch()">æµ‹è¯•åŸºç¡€æœç´¢</button>
        <button onclick="testTypeSearch()">æµ‹è¯•ç±»å‹æœç´¢</button>
        <button onclick="testCombinedSearch()">æµ‹è¯•ç»„åˆæœç´¢</button>
        <button onclick="testAllTypes()">æµ‹è¯•æ‰€æœ‰ç±»å‹</button>
        <button onclick="testPageWithType()">æµ‹è¯•åˆ†é¡µ+ç±»å‹</button>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="results"></div>
    </div>

    <script>
        // æ¨¡æ‹Ÿ API è°ƒç”¨
        async function callSearchAPI(searchData) {
            console.log('ğŸ” è°ƒç”¨æœç´¢ API:', searchData);
            
            // è¿™é‡Œæ¨¡æ‹Ÿå®é™…çš„ API è°ƒç”¨é€»è¾‘
            const mockResources = [
                { id: 1, name: 'Vue.js æ•™ç¨‹', type: 'study', content: 'å‰ç«¯æ¡†æ¶å­¦ä¹ èµ„æ–™' },
                { id: 2, name: 'å¤ä»‡è€…è”ç›Ÿ', type: 'movie', content: 'è¶…çº§è‹±é›„ç”µå½±' },
                { id: 3, name: 'è¿›å‡»çš„å·¨äºº', type: 'anime', content: 'çƒ­é—¨åŠ¨æ¼«ä½œå“' },
                { id: 4, name: 'æ•°æ®ç»“æ„ä¸ç®—æ³•', type: 'study', content: 'è®¡ç®—æœºä¸“ä¸šè¯¾ç¨‹' },
                { id: 5, name: 'æ–—ç ´è‹ç©¹', type: 'novel', content: 'ç„å¹»å°è¯´ç»å…¸' },
                { id: 6, name: '4Ké£æ™¯å£çº¸', type: 'wallpaper', content: 'é«˜æ¸…å£çº¸åˆé›†' }
            ];

            let filtered = mockResources;
            
            // æŒ‰æœç´¢è¯è¿‡æ»¤
            if (searchData.searchTerm) {
                filtered = filtered.filter(resource =>
                    resource.name.toLowerCase().includes(searchData.searchTerm.toLowerCase()) ||
                    resource.content.toLowerCase().includes(searchData.searchTerm.toLowerCase())
                );
            }
            
            // æŒ‰ç±»å‹è¿‡æ»¤
            if (searchData.type) {
                filtered = filtered.filter(resource => resource.type === searchData.type);
            }

            const result = {
                total: filtered.length,
                list: filtered,
                pageNum: searchData.page || 1,
                pageSize: searchData.size || 10
            };

            console.log('âœ… API å“åº”:', result);
            return result;
        }

        function displayResult(title, result) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = 'test-result';
            resultDiv.innerHTML = `<strong>${title}</strong>\n${JSON.stringify(result, null, 2)}`;
            resultsDiv.appendChild(resultDiv);
        }

        async function testBasicSearch() {
            console.log('ğŸ§ª æµ‹è¯•åŸºç¡€æœç´¢...');
            const result = await callSearchAPI({
                searchTerm: 'Vue',
                page: 1,
                size: 10
            });
            displayResult('åŸºç¡€æœç´¢ (searchTerm: "Vue")', result);
        }

        async function testTypeSearch() {
            console.log('ğŸ§ª æµ‹è¯•ç±»å‹æœç´¢...');
            const result = await callSearchAPI({
                type: 'study',
                page: 1,
                size: 10
            });
            displayResult('ç±»å‹æœç´¢ (type: "study")', result);
        }

        async function testCombinedSearch() {
            console.log('ğŸ§ª æµ‹è¯•ç»„åˆæœç´¢...');
            const result = await callSearchAPI({
                searchTerm: 'æ•°æ®',
                type: 'study',
                page: 1,
                size: 10
            });
            displayResult('ç»„åˆæœç´¢ (searchTerm: "æ•°æ®", type: "study")', result);
        }

        async function testAllTypes() {
            console.log('ğŸ§ª æµ‹è¯•æ‰€æœ‰ç±»å‹...');
            const types = ['study', 'movie', 'anime', 'novel', 'wallpaper'];

            for (const type of types) {
                const result = await callSearchAPI({
                    type: type,
                    page: 1,
                    size: 10
                });
                displayResult(`ç±»å‹æœç´¢ (type: "${type}")`, result);
            }
        }

        async function testPageWithType() {
            console.log('ğŸ§ª æµ‹è¯•åˆ†é¡µ+ç±»å‹...');

            // æ¨¡æ‹Ÿ getResourcesPage API è°ƒç”¨
            async function callPageAPI(page, size, type) {
                console.log('ğŸ“„ è°ƒç”¨åˆ†é¡µ API:', { page, size, type });

                const mockResources = [
                    { id: 1, name: 'Vue.js æ•™ç¨‹', type: 'study', content: 'å‰ç«¯æ¡†æ¶å­¦ä¹ èµ„æ–™' },
                    { id: 2, name: 'React å…¥é—¨', type: 'study', content: 'React å­¦ä¹ èµ„æ–™' },
                    { id: 3, name: 'å¤ä»‡è€…è”ç›Ÿ', type: 'movie', content: 'è¶…çº§è‹±é›„ç”µå½±' },
                    { id: 4, name: 'è¿›å‡»çš„å·¨äºº', type: 'anime', content: 'çƒ­é—¨åŠ¨æ¼«ä½œå“' },
                    { id: 5, name: 'æ•°æ®ç»“æ„ä¸ç®—æ³•', type: 'study', content: 'è®¡ç®—æœºä¸“ä¸šè¯¾ç¨‹' },
                    { id: 6, name: 'æ–—ç ´è‹ç©¹', type: 'novel', content: 'ç„å¹»å°è¯´ç»å…¸' }
                ];

                let filtered = mockResources;

                // æŒ‰ç±»å‹è¿‡æ»¤
                if (type) {
                    filtered = filtered.filter(resource => resource.type === type);
                }

                const start = (page - 1) * size;
                const end = start + size;
                const list = filtered.slice(start, end);

                const result = {
                    total: filtered.length,
                    list: list,
                    pageNum: page,
                    pageSize: size
                };

                console.log('âœ… åˆ†é¡µ API å“åº”:', result);
                return result;
            }

            // æµ‹è¯•ä¸åŒçš„åˆ†é¡µ+ç±»å‹ç»„åˆ
            const result1 = await callPageAPI(1, 3, 'study');
            displayResult('åˆ†é¡µ+ç±»å‹ (page: 1, size: 3, type: "study")', result1);

            const result2 = await callPageAPI(1, 5, '');
            displayResult('åˆ†é¡µæ— ç±»å‹ (page: 1, size: 5, type: "")', result2);
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.onload = function() {
            console.log('ğŸ“‹ æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•ç±»å‹æœç´¢åŠŸèƒ½');
            console.log('ğŸ’¡ ç‚¹å‡»æŒ‰é’®æ‰§è¡Œä¸åŒçš„æµ‹è¯•ç”¨ä¾‹');
        };
    </script>
</body>
</html>
